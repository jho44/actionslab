name: CD

on: workflow_dispatch

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: checkout
        uses: actions/checkout@v2

      - name: create "build"
        run: echo "pancakes" > pancakes.txt

      - name: push builds to `deployment`
        shell: bash
        run: |
          set -x
          git update-index -q --refresh
          changes=$(git status --porcelain)
          if [[ "${changes}" ]]; then
            git checkout deployment
            git add --force pancakes.txt
            git commit -m "pushing builds" --no-verify
            git push
          fi
